<?xml version="1.0"?>
<fest:template xmlns:fest="http://fest.mail.ru" context_name="json">

  <fest:set name="element">
    <fest:script>
      var blockParams = params.baseParams || params.forParams || params;
      var attrs = blockParams.attrs || {};
      var baseClass = params.baseClass || params.forClass || '';
      var elem = params.elem;
      var htmlDeep = params.htmlDeep;

      if (elem && htmlDeep && !elem.htmlDeep) {
        elem.htmlDeep = htmlDeep
      } else if (!elem && htmlDeep) {
        params.html = htmlDeep;
      }

      if (params.href) {
        attrs.href = params.href;
      }
    </fest:script>

    <fest:element name="{(attrs.href && 'a') || params.tagName || 'div'}">
      <fest:attributes>

        <fest:attribute name="class" value="{baseClass}" />

        <fest:each iterate="attrs" index="attrName" value="attrValue">
          <fest:attribute name="{attrName}">
            <fest:value>attrValue</fest:value>
          </fest:attribute>
        </fest:each>
      </fest:attributes>

      <fest:if test="params.htmlPrepend">
        <fest:value output="text">params.htmlPrepend</fest:value>
      </fest:if>
      <fest:if test="params.html">
        <fest:value output="text">params.html</fest:value>
      </fest:if>
      <fest:if test="params.elem">
        <fest:get name="element">params.elem</fest:get>
      </fest:if>
      <fest:if test="params.elems">
        <fest:for iterate="params.elems" index="i" value="elem">
          <fest:if test="elem">
            <fest:get name="element">elem</fest:get>
          </fest:if>
        </fest:for>
      </fest:if>
      <fest:if test="params.htmlAppend">
        <fest:value output="text">params.htmlAppend</fest:value>
      </fest:if>
    </fest:element>
  </fest:set>

  <fest:set name="bigsearch">
		<fest:get name="element">
			<fest:params>params</fest:params>
			<fest:params>
				{
					baseClass: 'bigsearch'
				}
			</fest:params>
			<fest:param name="html">
				<fest:get name="form">
					<fest:params>params.form</fest:params>
					<fest:param name="html">
						<fest:if test="params.input">
							<fest:get name="cell">
								<fest:params>
									{
										mods: ['full'],
										mix: ['padding_right_10']
									}
								</fest:params>
								<fest:param name="html">
									<fest:get name="input">
										<fest:params>params.input</fest:params>
									</fest:get>
								</fest:param>
							</fest:get>
						</fest:if>

						<fest:if test="params.button">
							<fest:get name="cell">
								<fest:params>
									{
										mods: ['right']
									}
								</fest:params>
								<fest:param name="html">
									<fest:get name="button">
										params.button
									</fest:get>
								</fest:param>
							</fest:get>
						</fest:if>

						<fest:if test="params.html">
							<fest:value output="text">
								params.html
							</fest:value>
						</fest:if>
					</fest:param>
				</fest:get>
			</fest:param>
		</fest:get>
	</fest:set>

  <fest:get name="bigsearch">
    <fest:params>
      {
        form: {
          attrs: {
            method: 'GET',
            action: '/search/'
          }
        },
        "input": {
          "icon": {
            "mods": [
              "zoom"
            ],
            "tag": "i",
            "attrs": {}
          },
          "attrs": {
            "type": "text",
            "name": "q",
            "placeholder": "Поиск"
          }
        },
        "button": {
          "text": "Найти"
        }
      }
    </fest:params>
  </fest:get>
</fest:template>
